import React from "react";
import { Container } from "reactstrap";
import Title from "../components/title/title";

// css
import "../assets/css/_catalogs.scss";
import { useQuery } from "react-query";
import { catalog } from "../queries/queries";
import { saveAs } from "file-saver";
import { useTranslation } from "react-i18next";
import { baseUrl } from "../services/api";

const Catalogs = () => {
  const { t } = useTranslation();

  const { data, isLoading } = useQuery(["catalogs"], catalog, {
    refetchOnWindowFocus: false,
  });

  const download = (fileName) => {
    var oReq = new XMLHttpRequest();

    var URLToPDF = `${baseUrl}download/${fileName}`

    oReq.open("GET", URLToPDF, true);

    oReq.responseType = "blob";

    oReq.onload = function () {
      var file = new Blob([oReq.response], {
        type: "application/pdf",
      });

      saveAs(file, "kataloq.pdf");
    };

    oReq.send();
  };

  return (
    <div className="catalogs">
      <Title title={t("kataloq")} />
      <Container>
        <div className="catalogs__wrapper">
          {isLoading === false &&
            data !== undefined &&
            data.data.map((item) => (
              <div className="catalogs__items" key={item.id}>
                <p>
                  <svg
                    width={46}
                    height={46}
                    viewBox="0 0 46 46"
                    fill="none"
                    xmlns="http://www.w3.org/2000/svg"
                  >
                    <path
                      d="M7.66732 11.5H3.83398V38.3333C3.83398 40.4417 5.55898 42.1667 7.66732 42.1667H34.5007V38.3333H7.66732V11.5ZM38.334 3.83333H15.334C13.2257 3.83333 11.5007 5.55833 11.5007 7.66666V30.6667C11.5007 32.775 13.2257 34.5 15.334 34.5H38.334C40.4423 34.5 42.1673 32.775 42.1673 30.6667V7.66666C42.1673 5.55833 40.4423 3.83333 38.334 3.83333ZM38.334 30.6667H15.334V7.66666H38.334V30.6667ZM19.1673 17.25H34.5007V21.0833H19.1673V17.25ZM19.1673 23H26.834V26.8333H19.1673V23ZM19.1673 11.5H34.5007V15.3333H19.1673V11.5Z"
                      fill="#BF0807"
                    />
                  </svg>
                  {item.title}
                </p>
                <p>
                  <a href={item.file} target="_blank">
                    <span>
                      <svg
                        width={30}
                        height={20}
                        viewBox="0 0 30 20"
                        fill="none"
                        xmlns="http://www.w3.org/2000/svg"
                      >
                        <path
                          d="M13.6909 0.0412064C11.6346 0.193521 9.68968 0.714914 8.00248 1.56437C6.46174 2.33767 5.29593 3.2047 3.83721 4.66343C2.48393 6.02256 1.16581 7.68633 0.263625 9.1802C0.0234333 9.57857 0 9.64887 0 10.0004C0 10.3519 0.0234333 10.4222 0.263625 10.8205C0.656133 11.465 1.59347 12.7831 2.23788 13.5915C2.90573 14.4293 4.58707 16.1399 5.30179 16.7023C6.95384 18.0146 8.81093 18.9636 10.6915 19.4557C13.978 20.3169 17.6922 20.147 20.6799 18.9929C22.6952 18.2196 24.3062 17.1358 26.0754 15.3666C27.4053 14.0309 28.4891 12.6776 29.526 11.049C30.1001 10.141 30.1001 9.85977 29.5318 8.96344C28.2137 6.88959 26.4738 4.84504 24.8979 3.5152C23.6735 2.48413 21.8809 1.43549 20.4104 0.896523C18.5358 0.211098 15.9347 -0.122828 13.6909 0.0412064ZM15.5832 3.79054C17.1063 3.96043 18.4362 4.6107 19.4614 5.68278C20.0062 6.25104 20.2757 6.65526 20.6213 7.38169C21.7461 9.76604 21.2189 12.619 19.3149 14.4644C17.4285 16.2864 14.6868 16.755 12.3494 15.6537C11.6229 15.308 11.2187 15.0385 10.6504 14.4937C8.72305 12.6483 8.18409 9.77775 9.31474 7.38169C10.2521 5.40158 12.074 4.07174 14.2357 3.7964C14.8099 3.7261 14.9856 3.7261 15.5832 3.79054Z"
                          fill="black"
                        />
                        <path
                          d="M14.1477 6.34473C13.4974 6.47947 12.8354 6.84855 12.3257 7.35822C10.8553 8.83453 10.8494 11.1661 12.3257 12.6366C13.8079 14.1129 16.1395 14.1188 17.6041 12.6424C19.0862 11.1544 19.0862 8.84624 17.6041 7.35822C16.696 6.44432 15.4131 6.06939 14.1477 6.34473Z"
                          fill="black"
                        />
                      </svg>
                      {t("bax")}
                    </span>
                  </a>
                  <a
                    href={item.file}
                    onClick={(e) => {
                      e.preventDefault();
                      download(item.fileName);
                    }}
                  >
                    <span>
                      <svg
                        width={22}
                        height={22}
                        viewBox="0 0 22 22"
                        fill="none"
                        xmlns="http://www.w3.org/2000/svg"
                      >
                        <path
                          d="M9.3457 0.0601368C9.18672 0.133183 9.04492 0.283573 8.98477 0.442558C8.95039 0.524199 8.9375 1.98943 8.9375 5.09607V9.62498H7.51094C6.20898 9.62498 6.06289 9.63357 5.90391 9.70662C5.6418 9.82693 5.52148 10.0203 5.52148 10.3168C5.52148 10.5316 5.54297 10.5875 5.67188 10.7508C5.75352 10.8539 6.88789 12.1558 8.19414 13.6469C9.82266 15.5117 10.6133 16.3797 10.7121 16.4312C10.9012 16.5172 11.0988 16.5172 11.2879 16.4312C11.3867 16.3797 12.1773 15.5117 13.8059 13.6469C15.1121 12.1558 16.2465 10.8539 16.3281 10.7508C16.4613 10.5832 16.4785 10.5359 16.4785 10.3125C16.4785 10.0976 16.457 10.0375 16.3453 9.89998C16.1348 9.64217 16.0789 9.63357 14.4934 9.62928L13.0625 9.62498L13.0539 5.03162C13.041 0.464043 13.041 0.433964 12.9508 0.317949C12.9035 0.253496 12.809 0.158964 12.7445 0.111698C12.6328 0.0257607 12.5684 0.0214653 11.0516 0.0128708C9.80117 0.00427628 9.44883 0.0128708 9.3457 0.0601368Z"
                          fill="black"
                        />
                        <path
                          d="M0.694531 18.034L0.707422 20.9473L0.819141 21.1879C0.960938 21.493 1.19297 21.725 1.49805 21.8668L1.73867 21.9785H10.9984H20.2582L20.4988 21.8668C20.8039 21.725 21.0359 21.493 21.1777 21.1879L21.2895 20.9473L21.3023 18.034L21.3152 15.125H19.9359H18.5609V17.1875V19.25H10.9984H3.43594V17.1875V15.125H2.06094H0.681641L0.694531 18.034Z"
                          fill="black"
                        />
                      </svg>
                      {t("yukle")}
                    </span>
                  </a>
                </p>
              </div>
            ))}
        </div>
      </Container>
    </div>
  );
};

export default Catalogs;
